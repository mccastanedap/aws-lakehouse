from pathlib import Path
import boto3

from utils.config import load_config

def upload_file_to_s3(local_path: Path, bucket: str, key: str, profile: str, region: str):
    session = boto3.Session(profile_name=profile, region_name=region)
    s3 = session.client("s3")
    print(f"Uploading {local_path} â†’ s3://{bucket}/{key}")
    s3.upload_file(str(local_path), bucket, key)

def main():
    cfg = load_config()
    profile = cfg["aws_profile"]
    region = cfg["region"]
    bucket = cfg["s3"]["bucket"]
    base_prefix = cfg["s3"]["base_prefix"]
    bronze_prefix = cfg["s3"]["bronze_prefix"]

    # Example local sample file (you can add one under a new "data" folder)
    local_file = Path("data/orders_raw.csv")
    s3_key = f"{base_prefix}{bronze_prefix}orders/{local_file.name}"

    upload_file_to_s3(local_file, bucket, s3_key, profile, region)

if __name__ == "__main__":
    main()
